package me.alek.serversecurity.malware.checks.impl.known;


import me.alek.serversecurity.malware.enums.MalwareType;
import me.alek.serversecurity.malware.checks.BaseCheck;
import me.alek.serversecurity.malware.checks.types.MalwareNode;
import me.alek.serversecurity.model.PluginProperties;
import org.objectweb.asm.tree.ClassNode;

import java.io.File;
import java.nio.file.Path;
import java.util.Arrays;
import java.util.List;

public class ThiccIndustriesCheck extends BaseCheck implements MalwareNode {

    private final List<String> classes = Arrays.asList("Injector", "DWeb", "Debugger", "Config");

    @Override
    public boolean processFileInJar(Path classPath, ClassNode classNode, File file, boolean isClass) {
        return false;
    }

    @Override
    public boolean preProcessJAR(File file, Path rootFolder, PluginProperties pluginProperties) {
        for (String variant : classes) {

            String className = "com/thiccindustries/debugger/" + variant + ".class";

            if (resolve(rootFolder, className)) {
                return true;
            }
        }
        return false;
    }

    @Override
    public MalwareType getType() {
        return MalwareType.THICCINDUSTRIES;
    }

}
