package me.alek.serversecurity.malware.constants.checks;

import me.alek.serversecurity.malware.constants.Container;
import me.alek.serversecurity.malware.constants.Registery;
import me.alek.serversecurity.malware.obfuscation.AbstractObfHandler;
import me.alek.serversecurity.malware.obfuscation.ClassObfLibrary;
import me.alek.serversecurity.malware.obfuscation.FieldObfLibrary;
import me.alek.serversecurity.malware.obfuscation.MethodObfLibrary;
import me.alek.serversecurity.malware.obfuscation.impl.classes.ClassLengthFeature;
import me.alek.serversecurity.malware.obfuscation.impl.classes.InnerClassLengthFeature;
import me.alek.serversecurity.malware.obfuscation.impl.classes.InterfaceLengthFeature;
import me.alek.serversecurity.malware.obfuscation.impl.classes.RepetitiveWordFeature;
import me.alek.serversecurity.malware.obfuscation.impl.fields.*;
import me.alek.serversecurity.malware.obfuscation.impl.methods.*;

import java.util.Collections;
import java.util.List;

public class Obfuscation {

    public static class ObfContainer extends Container<AbstractObfHandler> {

        @Override
        public Registery<AbstractObfHandler> getRegistery() {
            return new ObfRegistery(this);
        }
    }

    public static class ObfRegistery extends Registery<AbstractObfHandler> {

        public ObfRegistery(Container<AbstractObfHandler> container) {
            super(container);
        }

        @Override
        public List<AbstractObfHandler> getElements() {
            return Collections.singletonList(new AbstractObfHandler(
                    new ClassObfLibrary(
                            new ClassLengthFeature(),
                            new RepetitiveWordFeature(),
                            new InterfaceLengthFeature(),
                            new InnerClassLengthFeature()
                    ),
                    new MethodObfLibrary(
                            new MethodCharOccurenceFeature(),
                            new MethodCharSpecialFeature(),
                            new MethodNoLetterCharFeature(),
                            new MethodLengthFeature(),
                            new AllatoriMethodFeature()
                    ),
                    new FieldObfLibrary(
                            new FieldBranchlockFeature(),
                            new FieldCharOccurenceFeature(),
                            new FieldCharSpecialFeature(),
                            new FieldLengthFeature(),
                            new NumberSizeFeature(),
                            new FieldByteArrayFeature(),
                            new StringNonAsciiFeature(),
                            new StringVowelFeature(),
                            new StringBigramsFeature(),
                            new StringWordLengthFeature()
                    )
            ));
        }
    }



}
