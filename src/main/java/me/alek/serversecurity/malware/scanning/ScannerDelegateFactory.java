package me.alek.serversecurity.malware.scanning;

import me.alek.serversecurity.malware.model.ResultData;

import java.util.function.Function;
import java.util.function.Supplier;

public class ScannerDelegateFactory<T> {

    public static Function<Boolean, ScannerDelegateFactory<ResultData>> MALWARE_SCANNER_FACTORY =
            (ignoreServersideChecks) -> new ScannerDelegateFactory<>(() -> new MalwareScanner.MalwareScannerDelegate(ignoreServersideChecks));

    private final Supplier<ScannerDelegate<T>> scannerDelegateSupplier;

    public ScannerDelegateFactory(Supplier<ScannerDelegate<T>> scannerDelegateSupplier) {
        this.scannerDelegateSupplier = scannerDelegateSupplier;
    }

    public ScannerDelegate<T> create() {
        return scannerDelegateSupplier.get();
    }
}
