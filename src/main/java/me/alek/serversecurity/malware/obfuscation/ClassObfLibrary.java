package me.alek.serversecurity.malware.obfuscation;

import me.alek.serversecurity.malware.model.AttributeStatus;
import me.alek.serversecurity.malware.obfuscation.impl.AbstractClassObfFeature;
import me.alek.serversecurity.malware.obfuscation.impl.AbstractObfFeature;
import org.objectweb.asm.tree.ClassNode;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class ClassObfLibrary extends BaseAbstractHandler {

    private final ArrayList<AbstractObfFeature> implementedAbstractClassFeatures = new ArrayList<>();

    public ClassObfLibrary(AbstractObfFeature... implementedAbstractClassFeatures) {
        this.implementedAbstractClassFeatures.addAll(Arrays.asList(implementedAbstractClassFeatures));
    }

    @Override
    public List<AbstractObfFeature> getImplementedFeatures() {
        return implementedAbstractClassFeatures;
    }

    @Override
    public void affectAttributes(ClassNode classNode, AbstractObfFeature abstractObfFeature, AttributeStatus attributeStatusModel) {
        AbstractClassObfFeature feature = (AbstractClassObfFeature) abstractObfFeature;
        feature.affectAttributeStatus(attributeStatusModel, classNode);
    }
}
