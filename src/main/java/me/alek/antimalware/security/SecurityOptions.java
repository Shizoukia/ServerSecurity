package me.alek.antimalware.security;

import me.alek.antimalware.security.operator.OperatorManager;
import org.bukkit.Bukkit;
import org.bukkit.configuration.file.FileConfiguration;

import java.util.ArrayList;
import java.util.List;

public class SecurityOptions {

    private boolean enabled = false;
    private boolean preventCancelledMaliciousChatEvents = false;
    private boolean opProxyBlockerEnabled = false;
    private boolean throwExceptionOnOp = false;

    public SecurityOptions(final SecurityConfig securityConfig) {
        final FileConfiguration config = securityConfig.getFileConfiguration();
        this.enabled = config.getBoolean("security-enabled");
        if (enabled) {
            this.preventCancelledMaliciousChatEvents = config.getBoolean("prevent-cancelled-malicious-chat-event");
            this.opProxyBlockerEnabled = config.getBoolean("op-proxy-blocker");
            this.throwExceptionOnOp = config.getBoolean("throw-exception-on-op");
        }
        if (opProxyBlockerEnabled) {
            List<String> opPlayersAllowed = config.getStringList("target");
            OperatorManager.get().setAllowedOpPlayers(opPlayersAllowed);
        }
    }

    public boolean isEnabled() {
        return enabled;
    }

    public boolean isPreventCancelledMaliciousChatEvents() {
        return preventCancelledMaliciousChatEvents;
    }

    public boolean isOpProxyBlockerEnabled() {
        return opProxyBlockerEnabled;
    }

    public boolean isThrowExceptionOnOp() {
        return throwExceptionOnOp;
    }

}
