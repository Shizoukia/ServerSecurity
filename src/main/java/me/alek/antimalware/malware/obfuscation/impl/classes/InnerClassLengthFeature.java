package me.alek.antimalware.malware.obfuscation.impl.classes;

import me.alek.antimalware.malware.enums.Risk;
import me.alek.antimalware.malware.model.AttributeStatus;
import me.alek.antimalware.malware.obfuscation.impl.AbstractClassObfFeature;
import me.alek.antimalware.malware.obfuscation.impl.AbstractLengthBasedObfFeature;
import org.objectweb.asm.tree.ClassNode;
import org.objectweb.asm.tree.InnerClassNode;

public class InnerClassLengthFeature extends AbstractLengthBasedObfFeature implements AbstractClassObfFeature {
    @Override
    public void affectAttributeStatus(AttributeStatus attributeStatusModel, ClassNode classNode) {
        for (InnerClassNode innerClassPath : classNode.innerClasses) {
            affectAttributeStatus(attributeStatusModel, fixClass(innerClassPath.name));
        }
    }

    @Override
    public Risk getFeatureRisk() {
        return Risk.HIGH;
    }

    @Override
    public String getName() {
        return "Super Class Name Length";
    }

}
